{
    "name": "dino",
    "user_parameters": {
        "___n_layer": 8,
        "___n_dim": 512,
        "___n_head": 8,
        "___in_channels": 3,
        "___dropout_p": 0.0,
        "___patch_size": 16,
        "___img_size": 224,
        "___n_projection": 64
    },
    "network": [
        {
            "class": "ApplyModule",
            "args": {
                "name": "backbone",
                "network": [
                    {
                        "class": "SharedVariablesModule",
                        "args": "{'n_aug': input.shape[1]}"
                    },
                    {
                        "class": "EvalModule",
                        "args": "input.reshape(-1,*input.shape[-3:])"
                    },
                    {
                        "class": "ConfigModule",
                        "args": "../vit/vit.json",
                        "kwargs": {
                            "user_parameters": {
                                "___n_layer": "___n_layer",
                                "___n_dim": "___n_dim",
                                "___n_head": "___n_head",
                                "___in_channels": "___in_channels",
                                "___dropout_p": "___dropout_p",
                                "___patch_size": "___patch_size",
                                "___img_size": "___img_size"
                            }
                        }
                    },
                    {
                        "class": "EvalModule",
                        "args": "input.reshape(-1, variables['n_aug'], *input.shape[1:])"
                    }
                ]
            }
        },
        {
            "class": "AggregateInput",
            "args": "cat",
            "kwargs": {
                "dim": 1
            }
        },
        {
            "class": "Linear",
            "args": ["___n_dim", "___n_projection"],
            "kwargs": {
                "bias": false
            }
        }
    ]
}