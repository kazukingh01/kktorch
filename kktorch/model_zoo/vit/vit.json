{
    "name": "vit",
    "user_parameters": {
        "___n_layer": 12,
        "___n_dim": 512,
        "___n_head": 8,
        "___in_channels": 3,
        "___dropout_p": 0.0,
        "___patch_size": 16,
        "___img_size": 224
    },
    "network": [
        {
            "class": "SharedVariablesModule",
            "args": "{'___b': input.shape[0], '___c': input.shape[1], '___h': input.shape[2], '___w': input.shape[3]}"
        },
        {
            "class": "PatchEmbed",
            "kwargs": {
                "patch_size": "___patch_size",
                "in_channels": "___in_channels",
                "out_dim": "___n_dim"
            }
        },
        {
             "class": "EvalModule",
             "args": "input.reshape(-1, variables['___w'] // ___patch_size, variables['___h'] // ___patch_size, ___n_dim).permute(0, 3, 1, 2)"
        },
        {
            "class": "PositionalEncoding",
            "args": ["___n_dim", "___img_size // ___patch_size", "___img_size // ___patch_size"],
            "kwargs": {
                "init_eval": "torch.nn.init.trunc_normal_(param, mean=0.0, std=0.02, a=-2.0, b=2.0)", 
                "requires_grad": true,
                "add_type": "interpolate"
            }
        },
        {
            "class": "EvalModule",
            "args": "input.permute(0, 2, 3, 1).reshape(input.shape[0], -1, ___n_dim)"
        },
        {
            "class": "ParameterModule",
            "args": [1, 1, "___n_dim"],
            "kwargs": {
                "init_type": "eval",
                "init_timing": "before",
                "init_eval_str": "init.trunc_normal_(param, mean=0.0, std=0.02, a=-2.0, b=2.0)",
                "requires_grad": true, 
                "dtype": "torch.float32",
                "output_type": "torch.cat([param.expand(input.shape[0], -1, -1), input], dim=1)", 
                "name": "cls_token"
            }
        },
        {
            "class": "Dropout",
            "kwargs": {
                "p": "___dropout_p"
            }
        },
        {
            "class": "RepeatModule",
            "args": "block.json",
            "kwargs": {
                "n_layers": "___n_layer"
            }
        },
        {
            "class": "LayerNorm",
            "args": "___n_dim"
        },
        {
            "class": "SelectIndexTensorInput",
            "args": 3,
            "kwargs": {"dim2": 0},
            "out_features": "___n_dim"
        }
    ]
}